<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="FoundationDB Rust Client API"><title>foundationdb - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-492a78a4a87dcc01.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="foundationdb" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0 (f6e511eec 2024-10-15)" data-channel="1.82.0" data-search-js="search-a99f1315e7cc5121.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-921df33f47b8780c.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-3b12f09e550e0385.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../foundationdb/index.html">foundationdb</a><span class="version">0.9.1</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Aliases</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">foundationdb</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/foundationdb/lib.rs.html#7-113">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="foundationdb-rust-client-api"><a class="doc-anchor" href="#foundationdb-rust-client-api">§</a>FoundationDB Rust Client API</h2>
<p>This is a wrapper library around the FoundationDB (Fdb) C API. It implements futures based interfaces over the Fdb future C implementations.</p>
<h3 id="prerequisites"><a class="doc-anchor" href="#prerequisites">§</a>Prerequisites</h3>
<ul>
<li>Rust 1.71.1 or more,</li>
<li>FoundationDB’s client installed.</li>
</ul>
<h3 id="platform-support"><a class="doc-anchor" href="#platform-support">§</a>Platform Support</h3>
<p>Support for different platforms (“targets”) are organized into three tiers, each with a different set of guarantees. For more information on the policies for targets at each tier, see the <a href="#target-tier-policy">Target Tier Policy</a>.</p>
<div><table><thead><tr><th>Platform</th><th>Tier</th><th>Notes</th></tr></thead><tbody>
<tr><td>linux x86_64</td><td>1</td><td></td></tr>
<tr><td>osx x86_64</td><td>2</td><td></td></tr>
<tr><td>Windows x86_64</td><td>3</td><td><a href="https://github.com/apple/foundationdb/issues/5135">Windows build has been officially discontinue, now maintained by the community</a></td></tr>
<tr><td>osx Silicon</td><td>3</td><td><a href="https://forums.foundationdb.org/t/arm-client-library/3072">Waiting for official dylib support</a></td></tr>
</tbody></table>
</div>
<p>For more information on the policies for targets at each tier, see the</p>
<h3 id="target-tier-policy"><a class="doc-anchor" href="#target-tier-policy">§</a>Target Tier Policy</h3><h4 id="tier-1"><a class="doc-anchor" href="#tier-1">§</a>Tier 1</h4>
<p><code>Tier 1</code> targets can be thought of as “guaranteed to work”. This means that:</p>
<ul>
<li>we are actively checking correctness with the <a href="https://github.com/apple/foundationdb/blob/master/bindings/bindingtester/spec/bindingApiTester.md">BindingTester</a>,</li>
<li>we are running classic Rust tests on each pull requests,</li>
<li>you can use the crate on the platform.</li>
</ul>
<h4 id="tier-2"><a class="doc-anchor" href="#tier-2">§</a>Tier 2</h4>
<p><code>Tier 2</code> targets can be thought of as “guaranteed to build”. This means that:</p>
<ul>
<li>we are running classic Rust tests on each pull requests,</li>
<li>you can use the crate on the platform.</li>
</ul>
<p>But we are not checking correctness.</p>
<h4 id="tier-3"><a class="doc-anchor" href="#tier-3">§</a>Tier 3</h4>
<p><code>Tier 3</code> targets are platforms we would like to have as Tier 2. You might be able to compile, but no CI has been set up.</p>
<h3 id="getting-started"><a class="doc-anchor" href="#getting-started">§</a>Getting Started</h3><h4 id="install-foundationdb"><a class="doc-anchor" href="#install-foundationdb">§</a>Install FoundationDB</h4>
<p>You first need to install FoundationDB. You can follow the official documentation:</p>
<ul>
<li><a href="https://apple.github.io/foundationdb/getting-started-linux.html">Getting Started on Linux</a></li>
<li><a href="https://apple.github.io/foundationdb/getting-started-mac.html">Getting started on macOS</a></li>
</ul>
<h4 id="add-dependencies-on-foundationdb-rs"><a class="doc-anchor" href="#add-dependencies-on-foundationdb-rs">§</a>Add dependencies on foundationdb-rs</h4><div class="example-wrap"><pre class="language-shell"><code>cargo add foundationdb -F embedded-fdb-include
cargo add futures
</code></pre></div>
<p>This Rust crate is not tied to any Async Runtime.</p>
<h4 id="exposed-features"><a class="doc-anchor" href="#exposed-features">§</a>Exposed features</h4><div><table><thead><tr><th>Features</th><th>Notes</th></tr></thead><tbody>
<tr><td><code>fdb-5_1</code></td><td>Support for FoundationDB 5.1.X</td></tr>
<tr><td><code>fdb-5_2</code></td><td>Support for FoundationDB 5.2.X</td></tr>
<tr><td><code>fdb-6_0</code></td><td>Support for FoundationDB 6.0.X</td></tr>
<tr><td><code>fdb-6_1</code></td><td>Support for FoundationDB 6.1.X</td></tr>
<tr><td><code>fdb-6_2</code></td><td>Support for FoundationDB 6.2.X</td></tr>
<tr><td><code>fdb-6_3</code></td><td>Support for FoundationDB 6.3.X</td></tr>
<tr><td><code>fdb-7_0</code></td><td>Support for FoundationDB 7.0.X</td></tr>
<tr><td><code>fdb-7_1</code></td><td>Support for FoundationDB 7.1.X</td></tr>
<tr><td><code>embedded-fdb-include</code></td><td>Use the locally embedded FoundationDB fdb_c.h and fdb.options files to compile</td></tr>
<tr><td><code>uuid</code></td><td>Support for the uuid crate for Tuples</td></tr>
<tr><td><code>num-bigint</code></td><td>Support for the bigint crate for Tuples</td></tr>
<tr><td><code>tenant-experimental</code></td><td>Experimental support for tenants. Require at least 7.1</td></tr>
</tbody></table>
</div><h4 id="hello-world-using-the-crate"><a class="doc-anchor" href="#hello-world-using-the-crate">§</a>Hello, World using the crate</h4>
<p>We are going to use the Tokio runtime for this example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>futures::prelude::<span class="kw-2">*</span>;

<span class="attr">#[tokio::main]
</span><span class="kw">async fn </span>main() {
    <span class="comment">// Safe because drop is called before the program exits
    </span><span class="kw">let </span>network = <span class="kw">unsafe </span>{ foundationdb::boot() };

    <span class="comment">// Have fun with the FDB API
    </span>hello_world().<span class="kw">await</span>.expect(<span class="string">"could not run the hello world"</span>);

    <span class="comment">// shutdown the client
    </span>drop(network);
}

<span class="kw">async fn </span>hello_world() -&gt; foundationdb::FdbResult&lt;()&gt; {
    <span class="kw">let </span>db = foundationdb::Database::default()<span class="question-mark">?</span>;

    <span class="comment">// write a value in a retryable closure
    </span><span class="kw">match </span>db
        .run(|trx, _maybe_committed| <span class="kw">async move </span>{
            trx.set(<span class="string">b"hello"</span>, <span class="string">b"world"</span>);
            <span class="prelude-val">Ok</span>(())
        })
        .<span class="kw">await
    </span>{
        <span class="prelude-val">Ok</span>(<span class="kw">_</span>) =&gt; <span class="macro">println!</span>(<span class="string">"transaction committed"</span>),
        <span class="prelude-val">Err</span>(<span class="kw">_</span>) =&gt; <span class="macro">eprintln!</span>(<span class="string">"cannot commit transaction"</span>),
    };

    <span class="comment">// read a value
    </span><span class="kw">match </span>db
        .run(|trx, _maybe_committed| <span class="kw">async move </span>{ <span class="prelude-val">Ok</span>(trx.get(<span class="string">b"hello"</span>, <span class="bool-val">false</span>).<span class="kw">await</span>.unwrap()) })
        .<span class="kw">await
    </span>{
        <span class="prelude-val">Ok</span>(slice) =&gt; <span class="macro">assert_eq!</span>(<span class="string">b"world"</span>, slice.unwrap().as_ref()),
        <span class="prelude-val">Err</span>(<span class="kw">_</span>) =&gt; <span class="macro">eprintln!</span>(<span class="string">"cannot commit transaction"</span>),
    }

    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
<h3 id="additional-notes"><a class="doc-anchor" href="#additional-notes">§</a>Additional notes</h3><h4 id="the-class-scheduling-tutorial"><a class="doc-anchor" href="#the-class-scheduling-tutorial">§</a>The class-scheduling tutorial</h4>
<p>The official FoundationDB’s tutorial is called the <a href="https://apple.github.io/foundationdb/class-scheduling.html">Class Scheduling</a>. You can find the Rust version in the <a href="https://github.com/foundationdb-rs/foundationdb-rs/tree/main/foundationdb/examples">examples</a>.</p>
<h4 id="the-blob-tutorial"><a class="doc-anchor" href="#the-blob-tutorial">§</a>The blob tutorial</h4>
<p>The official FoundationDB documentation provides also <a href="https://apple.github.io/foundationdb/largeval.html#modeling-large-values">another topic</a>
which is further discussed inside a <a href="https://apple.github.io/foundationdb/blob.html">design recipe</a>.
A Rust implementation can be found <a href="https://github.com/foundationdb-rs/foundationdb-rs/tree/main/foundationdb/examples/blob.rs">here</a>.</p>
<p>Another <a href="https://github.com/foundationdb-rs/foundationdb-rs/tree/main/foundationdb/examples/blob-with-manifest.rs">example</a>,
explores how to use subspaces to attach metadata to our blob.</p>
<h4 id="must-read-documentations"><a class="doc-anchor" href="#must-read-documentations">§</a>Must-read documentations</h4>
<ul>
<li><a href="https://apple.github.io/foundationdb/developer-guide.html">Developer Guide</a></li>
<li><a href="https://apple.github.io/foundationdb/data-modeling.html">Data Modeling Guide</a></li>
</ul>
<h4 id="initialization"><a class="doc-anchor" href="#initialization">§</a>Initialization</h4>
<p>Due to limitations in the C API, the Client and it’s associated Network can only be initialized and run once per the life of a process. Generally the <code>foundationdb::boot</code> function will be enough to initialize the Client. See <code>foundationdb::api</code> for more configuration options of the Fdb Client.</p>
<h4 id="migration-from-04-to-05"><a class="doc-anchor" href="#migration-from-04-to-05">§</a>Migration from 0.4 to 0.5</h4>
<p>The initialization of foundationdb API has changed due to undefined behavior being possible with only safe code (issues #170, #181, pulls #179, #182).</p>
<p>Previously you had to wrote <code>foundationdb::boot().expect("failed to initialize Fdb");</code>, now this can be converted to:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// Safe because drop is called before the program exits
</span><span class="kw">let </span>network = <span class="kw">unsafe </span>{ foundationdb::boot() };

<span class="comment">// do stuff

// cleanly shutdown the client
</span>drop(network);</code></pre></div>
<h4 id="api-stability"><a class="doc-anchor" href="#api-stability">§</a>API stability</h4>
<p><em>WARNING</em> Until the 1.0 release of this library, the API may be in constant flux.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="api/index.html" title="mod foundationdb::api">api</a></div><div class="desc docblock-short">Configuration of foundationDB API and Network</div></li><li><div class="item-name"><a class="mod" href="directory/index.html" title="mod foundationdb::directory">directory</a></div><div class="desc docblock-short">Directory provides a tool for managing related subspaces.</div></li><li><div class="item-name"><a class="mod" href="fdb_keys/index.html" title="mod foundationdb::fdb_keys">fdb_<wbr>keys</a></div><div class="desc docblock-short">Definitions of FDBKeys, used in api version 700 and more.</div></li><li><div class="item-name"><a class="mod" href="future/index.html" title="mod foundationdb::future">future</a></div><div class="desc docblock-short">Most functions in the FoundationDB API are asynchronous, meaning that they
may return to the caller before actually delivering their Fdbresult.</div></li><li><div class="item-name"><a class="mod" href="mapped_key_values/index.html" title="mod foundationdb::mapped_key_values">mapped_<wbr>key_<wbr>values</a></div><div class="desc docblock-short">Definitions of MappedKeyValues, used in api version 710 and more.</div></li><li><div class="item-name"><a class="mod" href="options/index.html" title="mod foundationdb::options">options</a></div><div class="desc docblock-short">Generated configuration types for use with the various <code>set_option</code> functions</div></li><li><div class="item-name"><a class="mod" href="tenant/index.html" title="mod foundationdb::tenant">tenant</a></div><div class="desc docblock-short">Implementation of the Tenants API. Experimental features exposed through the <code>tenant-experimental</code> feature.</div></li><li><div class="item-name"><a class="mod" href="tuple/index.html" title="mod foundationdb::tuple">tuple</a></div><div class="desc docblock-short">Implementation of the official tuple layer typecodes</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Database.html" title="struct foundationdb::Database">Database</a></div><div class="desc docblock-short">Represents a FoundationDB database</div></li><li><div class="item-name"><a class="struct" href="struct.FdbError.html" title="struct foundationdb::FdbError">FdbError</a></div><div class="desc docblock-short">The Standard Error type of FoundationDB</div></li><li><div class="item-name"><a class="struct" href="struct.KeySelector.html" title="struct foundationdb::KeySelector">KeySelector</a></div><div class="desc docblock-short">A <code>KeySelector</code> identifies a particular key in the database.</div></li><li><div class="item-name"><a class="struct" href="struct.MaybeCommitted.html" title="struct foundationdb::MaybeCommitted">Maybe<wbr>Committed</a></div><div class="desc docblock-short">Wrapper around the boolean representing whether the
previous transaction is still on fly
This wrapper prevents the boolean to be copy and force it
to be moved instead.
This pretty handy when you don’t want to see the <code>Database::run</code> closure
capturing the environment.</div></li><li><div class="item-name"><a class="struct" href="struct.RangeOption.html" title="struct foundationdb::RangeOption">Range<wbr>Option</a></div><div class="desc docblock-short"><code>RangeOption</code> represents a query parameters for range scan query.</div></li><li><div class="item-name"><a class="struct" href="struct.RetryableTransaction.html" title="struct foundationdb::RetryableTransaction">Retryable<wbr>Transaction</a></div><div class="desc docblock-short">A retryable transaction, generated by Database.run</div></li><li><div class="item-name"><a class="struct" href="struct.TransactOption.html" title="struct foundationdb::TransactOption">Transact<wbr>Option</a></div><div class="desc docblock-short">A set of options that controls the behavior of <code>Database::transact</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.Transaction.html" title="struct foundationdb::Transaction">Transaction</a></div><div class="desc docblock-short">In FoundationDB, a transaction is a mutable snapshot of a database.</div></li><li><div class="item-name"><a class="struct" href="struct.TransactionCancelled.html" title="struct foundationdb::TransactionCancelled">Transaction<wbr>Cancelled</a></div><div class="desc docblock-short">A cancelled transaction</div></li><li><div class="item-name"><a class="struct" href="struct.TransactionCommitError.html" title="struct foundationdb::TransactionCommitError">Transaction<wbr>Commit<wbr>Error</a></div><div class="desc docblock-short">A failed to commit transaction.</div></li><li><div class="item-name"><a class="struct" href="struct.TransactionCommitted.html" title="struct foundationdb::TransactionCommitted">Transaction<wbr>Committed</a></div><div class="desc docblock-short">A committed transaction.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.FdbBindingError.html" title="enum foundationdb::FdbBindingError">FdbBinding<wbr>Error</a></div><div class="desc docblock-short">This error represent all errors that can be throwed by <code>db.run</code>.
Layer developers may use the <code>CustomError</code>.</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.DatabaseTransact.html" title="trait foundationdb::DatabaseTransact">Database<wbr>Transact</a></div></li><li><div class="item-name"><a class="trait" href="trait.TransactError.html" title="trait foundationdb::TransactError">Transact<wbr>Error</a></div><div class="desc docblock-short">A trait that must be implemented to use <code>Database::transact</code> this application error types.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.boot.html" title="fn foundationdb::boot">boot</a><sup title="unsafe function">⚠</sup></div><div class="desc docblock-short">Initialize the FoundationDB Client API, this can only be called once per process.</div></li><li><div class="item-name"><a class="fn" href="fn.default_config_path.html" title="fn foundationdb::default_config_path">default_<wbr>config_<wbr>path</a></div><div class="desc docblock-short">Returns the default Fdb cluster configuration file path</div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.FdbResult.html" title="type foundationdb::FdbResult">FdbResult</a></div><div class="desc docblock-short">Alias for <code>Result&lt;..., FdbError&gt;</code></div></li></ul></section></div></main></body></html>